
<div class="student-dashboard-container d-flex vh-100">
  <!-- Sidebar -->
  <nav class="sidebar shadow-lg" [class.collapsed]="!isSidebarOpen">
    <div class="sidebar-header p-3 border-bottom bg-primary text-white">
      <div class="d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center" *ngIf="isSidebarOpen">
          <img [src]="studentAvatar" 
               [alt]="studentName" 
               class="rounded-circle me-2"
               width="32" height="32">
          <div class="user-info">
            <h6 class="mb-0 fw-medium text-truncate">{{ studentName }}</h6>
            <small class="text-light opacity-75">{{ studentClass }}</small>
          </div>
        </div>
        <button class="btn btn-link text-white p-0" (click)="toggleSidebar()">
          <i class="bi" [class.bi-chevron-left]="isSidebarOpen" [class.bi-chevron-right]="!isSidebarOpen"></i>
        </button>
      </div>
    </div>

    <div class="sidebar-menu p-2">
      <ul class="nav flex-column">
        <li class="nav-item mb-1">
          <a class="nav-link active rounded-3 d-flex align-items-center py-2 px-3" href="#">
            <i class="bi bi-house-door me-2"></i>
            <span *ngIf="isSidebarOpen">Ana Sayfa</span>
          </a>
        </li>
        <li class="nav-item mb-1">
          <a class="nav-link rounded-3 d-flex align-items-center py-2 px-3" 
             routerLink="/ogrenci-sayfasi/ogrenci-qr-kod-sayfasi">
            <i class="bi bi-qr-code me-2"></i>
            <span *ngIf="isSidebarOpen">QR Kod</span>
          </a>
        </li>
        <li class="nav-item mb-1">
          <a class="nav-link rounded-3 d-flex align-items-center py-2 px-3" href="#">
            <i class="bi bi-calendar-check me-2"></i>
            <span *ngIf="isSidebarOpen">Devamsızlık</span>
          </a>
        </li>
        <li class="nav-item mb-1">
          <a class="nav-link rounded-3 d-flex align-items-center py-2 px-3" href="#">
            <i class="bi bi-book me-2"></i>
            <span *ngIf="isSidebarOpen">Dersler</span>
          </a>
        </li>
        <li class="nav-item mb-1">
          <a class="nav-link rounded-3 d-flex align-items-center py-2 px-3" href="#">
            <i class="bi bi-clipboard-check me-2"></i>
            <span *ngIf="isSidebarOpen">Sınavlar</span>
          </a>
        </li>
        <li class="nav-item mb-1">
          <a class="nav-link rounded-3 d-flex align-items-center py-2 px-3" href="#">
            <i class="bi bi-person-circle me-2"></i>
            <span *ngIf="isSidebarOpen">Profil</span>
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content flex-grow-1 bg-light">
    <!-- Header -->
    <header class="header bg-white border-bottom p-3 shadow-sm">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h4 class="mb-0 fw-bold text-dark">Hoş Geldin, {{ studentName }}!</h4>
          <p class="text-muted mb-0 small">{{ studentTeacher }} • {{ studentClass }}</p>
        </div>
        <div class="d-flex align-items-center gap-3">
          <span class="badge bg-success px-3 py-2">Aktif Öğrenci</span>
          <div class="text-end">
            <small class="text-muted d-block">{{ 'now' | date:'dd/MM/yyyy' }}</small>
            <small class="text-muted">{{ 'now' | date:'HH:mm' }}</small>
          </div>
        </div>
      </div>
    </header>

    <!-- Dashboard Content -->
    <div class="content p-4">
      <!-- Quick Stats Cards -->
      <div class="row g-3 mb-4">
        <!-- Devamsızlık Card -->
        <div class="col-md-3 col-sm-6">
          <div class="card h-100 border-success border-start border-4 rounded-lg shadow-sm">
            <div class="card-body p-3">
              <div class="d-flex align-items-center">
                <div class="icon-bg rounded-circle bg-success-subtle p-2 me-3">
                  <i class="bi bi-calendar-check fs-4 text-success"></i>
                </div>
                <div>
                  <h6 class="text-muted mb-0 small">Bu Hafta Devam</h6>
                  <h4 class="mb-0">{{ thisWeekAttendance }}/5</h4>
                  <div class="small text-success mt-1">
                    %{{ getAttendancePercentage() }} Devam
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Ders İlerlemesi Card -->
        <div class="col-md-3 col-sm-6">
          <div class="card h-100 border-primary border-start border-4 rounded-lg shadow-sm">
            <div class="card-body p-3">
              <div class="d-flex align-items-center">
                <div class="icon-bg rounded-circle bg-primary-subtle p-2 me-3">
                  <i class="bi bi-book fs-4 text-primary"></i>
                </div>
                <div>
                  <h6 class="text-muted mb-0 small">Ders İlerlemesi</h6>
                  <h4 class="mb-0">{{ completedLessons }}/{{ totalLessons }}</h4>
                  <div class="small text-primary mt-1">
                    %{{ getLessonProgress() }} Tamamlandı
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sınav Başarısı Card -->
        <div class="col-md-3 col-sm-6">
          <div class="card h-100 border-warning border-start border-4 rounded-lg shadow-sm">
            <div class="card-body p-3">
              <div class="d-flex align-items-center">
                <div class="icon-bg rounded-circle bg-warning-subtle p-2 me-3">
                  <i class="bi bi-clipboard-check fs-4 text-warning"></i>
                </div>
                <div>
                  <h6 class="text-muted mb-0 small">Sınav Başarısı</h6>
                  <h4 class="mb-0">{{ passedExams }}/{{ totalExams }}</h4>
                  <div class="small text-warning mt-1">
                    %{{ getExamSuccessRate() }} Başarı
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Not Ortalaması Card -->
        <div class="col-md-3 col-sm-6">
          <div class="card h-100 border-info border-start border-4 rounded-lg shadow-sm">
            <div class="card-body p-3">
              <div class="d-flex align-items-center">
                <div class="icon-bg rounded-circle bg-info-subtle p-2 me-3">
                  <i class="bi bi-trophy fs-4 text-info"></i>
                </div>
                <div>
                  <h6 class="text-muted mb-0 small">Genel Ortalama</h6>
                  <h4 class="mb-0">{{ currentGrade }}</h4>
                  <div class="small text-info mt-1">
                    Mükemmel
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions Row -->
      <div class="row g-3 mb-4">
        <!-- QR Kod Kartı -->
        <div class="col-md-6">
          <div class="card h-100 shadow-sm">
            <div class="card-header bg-gradient-primary text-white">
              <h5 class="card-title mb-0 d-flex align-items-center">
                <i class="bi bi-qr-code me-2"></i>
                QR Kod İşlemleri
              </h5>
            </div>
            <div class="card-body p-4">
              <p class="text-muted mb-3">Sınıfa giriş/çıkış işlemleri için QR kodunu kullanın.</p>
              <div class="d-grid">
                <a routerLink="/ogrenci-sayfasi/ogrenci-qr-kod-sayfasi" 
                   class="btn btn-primary btn-lg">
                  <i class="bi bi-qr-code me-2"></i>
                  QR Kod Sayfası
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- Dersler Kartı -->
        <div class="col-md-6">
          <div class="card h-100 shadow-sm">
            <div class="card-header bg-gradient-success text-white">
              <h5 class="card-title mb-0 d-flex align-items-center">
                <i class="bi bi-book me-2"></i>
                Ders Programı
              </h5>
            </div>
            <div class="card-body p-4">
              <p class="text-muted mb-2">Bir sonraki ders:</p>
              <h6 class="fw-bold text-success mb-3">{{ nextLesson }}</h6>
              <div class="d-grid">
                <button class="btn btn-outline-success btn-lg">
                  <i class="bi bi-calendar-event me-2"></i>
                  Ders Programını Gör
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Progress Charts Row -->
      <div class="row g-3">
        <!-- Devamsızlık Grafiği -->
        <div class="col-md-6">
          <div class="card shadow-sm">
            <div class="card-header">
              <h5 class="card-title mb-0">Haftalık Devam Durumu</h5>
            </div>
            <div class="card-body">
              <div class="progress mb-2" style="height: 20px;">
                <div class="progress-bar bg-success" 
                     [style.width.%]="getAttendancePercentage()"
                     role="progressbar">
                  %{{ getAttendancePercentage() }}
                </div>
              </div>
              <small class="text-muted">Bu hafta {{ thisWeekAttendance }} gün devam ettiniz</small>
            </div>
          </div>
        </div>

        <!-- Ders İlerlemesi Grafiği -->
        <div class="col-md-6">
          <div class="card shadow-sm">
            <div class="card-header">
              <h5 class="card-title mb-0">Ders İlerlemesi</h5>
            </div>
            <div class="card-body">
              <div class="progress mb-2" style="height: 20px;">
                <div class="progress-bar bg-primary" 
                     [style.width.%]="getLessonProgress()"
                     role="progressbar">
                  %{{ getLessonProgress() }}
                </div>
              </div>
              <small class="text-muted">{{ completedLessons }}/{{ totalLessons }} ders tamamlandı</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
