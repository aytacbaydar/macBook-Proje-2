<!-- APK Download Section (Direct Download) 
<div class="apk-download-section" *ngIf="shouldShowAPKDownload()">
  <div class="container">
    <div class="apk-card">
      <div class="apk-header">
        <img src="/app-icon.png" alt="Kimya Ã–ÄŸreniyorum" class="app-icon">
        <div class="app-info">
          <h3>ðŸ“± Mobil UygulamayÄ± Ä°ndir</h3>
          <p>Android telefonunuz iÃ§in Ã¶zel geliÅŸtirildi</p>
        </div>
      </div>
      
      <div class="apk-features">
        <div class="feature">
          <i class="fas fa-rocket text-primary"></i>
          <span>Daha HÄ±zlÄ± EriÅŸim</span>
        </div>
        <div class="feature">
          <i class="fas fa-bell text-warning"></i>
          <span>AnlÄ±k Bildirimler</span>
        </div>
        <div class="feature">
          <i class="fas fa-wifi text-success"></i>
          <span>Ã‡evrimdÄ±ÅŸÄ± Ã‡alÄ±ÅŸma</span>
        </div>
      </div>

      <div class="apk-actions">
        <button class="btn btn-primary apk-download-btn" (click)="downloadAPK()">
          <i class="fas fa-download me-2"></i>
          APK Ä°ndir (Android)
        </button>
        
        <div class="install-steps">
          <small class="text-muted">
            <i class="fas fa-info-circle me-1"></i>
            Ä°ndirdikten sonra: Dosya â†’ Kur â†’ AÃ§
          </small>
        </div>
      </div>

      <button class="close-apk-section" (click)="hideAPKDownload()" aria-label="Kapat">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>
</div>
-->
<div class="container-full">
  <div class="row">
    <div class="col-12 d-block d-md-none mt-5">
      <div class="card-ana bg-blue">
        <div class="card-ana-header">
          <h4><i class="bi bi-lightning-charge-fill"></i>HÄ±zlÄ± EriÅŸim</h4>
          <button><i class="bi bi-bookmark-plus-fill"></i></button>
        </div>
        <div class="card-ana-body">
          <!--Ä°Ã§erik-->
          <div class="modern-quick-actions">
            <a href="ogrenci-sayfasi/ogrenci-islene-konular-sayfasi" class="modern-action-btn gradient-blue">
              <div class="action-icon">
                <i class="bi bi-book"></i>
              </div>
              <span>Yol Haritasi</span>
            </a>
            <a href="ogrenci-sayfasi/ogrenci-islene-konularin-pdf-sayfasi" class="modern-action-btn gradient-red">
              <div class="action-icon">
                <i class="bi bi-file-pdf"></i>
              </div>
              <span>Ä°slenen KonularÄ±n PDF'leri</span>
            </a>
            <a routerLink="ogrenci-qr-kod-sayfasi" class="modern-action-btn gradient-green">
              <div class="action-icon">
                <i class="bi bi-qr-code"></i>
              </div>
              <span>QR Kod</span>
            </a>
            <a routerLink="ogrenci-sinav-islemleri-sayfasi" class="modern-action-btn gradient-purple">
              <div class="action-icon">
                <i class="bi bi-clipboard-check"></i>
              </div>
              <span>SÄ±navlar</span>
            </a>
          </div>
          <!--Ä°Ã§erik Son-->
        </div>
      </div>
    </div>
    <div class="col-12">
        <div class="card-ana bg-green">
          <div class="card-ana-header">
            <h4><i class="bi bi-bar-chart-fill"></i> SÄ±nav PerformansÄ±m</h4>
            <button><i class="bi bi-bookmark-plus-fill"></i></button>
          </div>
          <div class="card-ana-body">
            <!--Ä°Ã§erik-->
            <div *ngIf="loadingExamResults" class="loading-section text-center py-3">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">YÃ¼kleniyor...</span>
              </div>
              <p class="mt-2">SÄ±nav sonuÃ§larÄ± yÃ¼kleniyor...</p>
            </div>
            <div *ngIf="!loadingExamResults" class="chart-container">
              <canvas id="comparisonChart" width="100%" height="600px"></canvas>
            </div>
            <!-- DetaylÄ± SÄ±nav Bilgileri -->
            <div class="sinav-detay-bilgileri mt-4" *ngIf="sinavSonuclari.length > 0">
            
              <!-- Desktop Table -->
              <div class="table-responsive d-none d-lg-block">
                <table class="table table-striped table-hover">
                  <thead>
                    <tr>
                      <th>SÄ±nav AdÄ±</th>
                      <th>SÄ±nav TÃ¼rÃ¼</th>
                      <th>DoÄŸru</th>
                      <th>YanlÄ±ÅŸ</th>
                      <th>BoÅŸ</th>
                      <th>Net</th>
                      <th>BaÅŸarÄ± %</th>
                      <th>KatÄ±lÄ±mcÄ±</th>
                      <th>SÄ±ralama</th>
                      <th>Tarih</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let sinav of sinavSonuclari"
                      [style.border-left]="'4px solid ' + getSinavTuruColor(sinav.sinav_turu)">
                      <td>
                          <span>{{ sinav.sinav_adi }}</span>
                      </td>
                      <td>
                          <span class="badge me-2" [style.background-color]="getSinavTuruColor(sinav.sinav_turu)">
                            {{ getSinavTuruLabel(sinav.sinav_turu) }}
                          </span>
                      </td>
                      <td>
                        <span class="badge bg-success">{{ sinav.dogru_sayisi }}</span>
                      </td>
                      <td>
                        <span class="badge bg-danger">{{ sinav.yanlis_sayisi }}</span>
                      </td>
                      <td>
                        <span class="badge bg-warning">{{ sinav.bos_sayisi }}</span>
                      </td>
                      <td>
                        <span class="badge bg-info">{{ calculateNet(sinav) }}</span>
                      </td>
                      <td>
                        <div class="progress" style="height: 20px;">
                          <div class="progress-bar" [style.width.%]="getSuccessPercentage(sinav)"
                            [style.background-color]="getSinavTuruColor(sinav.sinav_turu)">
                            {{ getSuccessPercentage(sinav) }}%
                          </div>
                        </div>
                      </td>
                      <td>
                        <i class="bi bi-people"></i>
                        <span class="ms-1">{{ sinav.katilimci_sayisi || 'Bilinmiyor' }}</span>
                      </td>
                      <td>
                        <i class="bi bi-trophy"></i>
                        <span class="ms-1">{{ sinav.siralama || 'Bilinmiyor' }}</span>
                      </td>
                      <td>
                        <small class="text-muted">{{ formatDate(sinav.gonderim_tarihi) }}</small>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            
              <!-- Mobile Cards -->
              <div class="d-lg-none">
                <div class="sinav-card mb-3" *ngFor="let sinav of sinavSonuclari"
                  [style.border-left]="'4px solid ' + getSinavTuruColor(sinav.sinav_turu)">
                  <div class="sinav-card-header">
                    <h6 class="mb-0 fw-bold">{{ sinav.sinav_adi }}</h6>
                    <small class="text-muted">{{ formatDate(sinav.gonderim_tarihi) }}</small>
                  </div>
            
                  <div class="sinav-card-body">
                    <!-- DoÄŸru/YanlÄ±ÅŸ/BoÅŸ -->
                    <div class="row mb-2">
                      <div class="col-4 text-center">
                        <span class="badge bg-success d-block mb-1">{{ sinav.dogru_sayisi }}</span>
                        <small class="text-muted">DoÄŸru</small>
                      </div>
                      <div class="col-4 text-center">
                        <span class="badge bg-danger d-block mb-1">{{ sinav.yanlis_sayisi }}</span>
                        <small class="text-muted">YanlÄ±ÅŸ</small>
                      </div>
                      <div class="col-4 text-center">
                        <span class="badge bg-warning d-block mb-1">{{ sinav.bos_sayisi }}</span>
                        <small class="text-muted">BoÅŸ</small>
                      </div>
                    </div>
            
                    <!-- Net ve BaÅŸarÄ± -->
                    <div class="row mb-2">
                      <div class="col-6 text-center">
                        <span class="badge bg-info d-block mb-1">{{ calculateNet(sinav) }}</span>
                        <small class="text-muted">Net</small>
                      </div>
                      <div class="col-6">
                        <div class="progress mb-1" style="height: 20px;">
                          <div class="progress-bar" [style.width.%]="getSuccessPercentage(sinav)"
                            [style.background-color]="getSinavTuruColor(sinav.sinav_turu)">
                            {{ getSuccessPercentage(sinav) }}%
                          </div>
                        </div>
                        <small class="text-muted">BaÅŸarÄ±</small>
                      </div>
                    </div>
            
                    <!-- KatÄ±lÄ±mcÄ± ve SÄ±ralama -->
                    <div class="row">
                      <div class="col-6 text-center">
                        <i class="bi bi-people text-primary"></i>
                        <span class="ms-1">{{ sinav.katilimci_sayisi || 'Bilinmiyor' }}</span>
                        <br><small class="text-muted">KatÄ±lÄ±mcÄ±</small>
                      </div>
                      <div class="col-6 text-center">
                        <i class="bi bi-trophy text-warning"></i>
                        <span class="ms-1">{{ sinav.siralama || 'Bilinmiyor' }}</span>
                        <br><small class="text-muted">SÄ±ralama</small>
                      </div>
                    </div>
                  </div>
                </div>
              </div>      
            </div>
            <!--Ä°Ã§erik Son-->
          </div>
        </div>
    </div>
    <div class="col-12 col-lg-4 mt-1">
        <div class="card-ana bg-orange">
          <div class="card-ana-header">
            <h4><i class="bi bi-book me-2"></i>Son Ä°ÅŸlenen Konular</h4>
            <button><i class="bi bi-bookmark-plus-fill"></i></button>
          </div>
          <div class="card-ana-body">
            <!--Ä°Ã§erik-->
            <div *ngIf="loadingTopics" class="loading-section text-center py-3">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">YÃ¼kleniyor...</span>
              </div>
              <p class="mt-2">Konular yÃ¼kleniyor...</p>
            </div>
            
            <div *ngIf="!loadingTopics && sonIslenenKonular.length > 0" class="topics-list">
              <div class="topic-item" *ngFor="let konu of sonIslenenKonular; let i = index">
                <div class="topic-icon">
                  <i class="bi bi-bookmark-check-fill"></i>
                </div>
                <div class="topic-content">
                  <h6 class="topic-title">{{ konu.konu_adi || konu.konu_baslik }}</h6>
                  <div class="topic-meta">
                    <small>
                      <i class="bi bi-calendar-check"></i>
                      {{ formatDate(konu.isleme_tarihi) }}
                    </small>
                    <span class="badge" *ngIf="konu.sinif_seviyesi">
                      {{ konu.sinif_seviyesi }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
            
            <div *ngIf="!loadingTopics && sonIslenenKonular.length === 0" class="empty-state text-center py-3">
              <i class="bi bi-journal-x text-muted" style="font-size: 2rem;"></i>
              <p class="text-muted mt-2">HenÃ¼z iÅŸlenen konu yok</p>
            </div>
            <!--Ä°Ã§erik Son-->
          </div>
        </div>
    </div>
    <div class="col-12 col-lg-8 mt-1">
        <div class="card-ana bg-blue">
          <div class="card-ana-header">
            <h4><i class="bi bi-lightning-charge-fill"></i>Konu Analizi</h4>
            <button><i class="bi bi-bookmark-plus-fill"></i></button>
          </div>
          <div class="card-ana-body">
            <!--Ä°Ã§erik-->
            <div *ngIf="loadingKonuAnalizi" class="loading-section text-center py-3">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">YÃ¼kleniyor...</span>
              </div>
              <p class="mt-2">Konu analizi yÃ¼kleniyor...</p>
            </div>

            <div *ngIf="!loadingKonuAnalizi && konuAnalizi.length > 0" class="konu-analizi-container">
              <div class="konu-item mb-4" *ngFor="let konu of konuAnalizi; let i = index">
                <div class="konu-header d-flex justify-content-between align-items-center mb-2">
                  <h6 class="konu-adi mb-0 fw-bold">{{ konu.konu_adi }}</h6>
                  <span class="badge" [style.background-color]="getKonuSuccessColor(konu.basari_orani)">
                    {{ getKonuSuccessText(konu.basari_orani) }}
                  </span>
                </div>
                
                <div class="progress mb-2" style="height: 25px;">
                  <div class="progress-bar" 
                       [style.width.%]="konu.basari_orani"
                       [style.background-color]="getKonuSuccessColor(konu.basari_orani)"
                       role="progressbar" 
                       [attr.aria-valuenow]="konu.basari_orani" 
                       aria-valuemin="0" 
                       aria-valuemax="100">
                    <span class="fw-bold">{{ konu.basari_orani }}%</span>
                  </div>
                </div>

                <div class="konu-detaylar">
                  <div class="row text-center">
                    <div class="col-3">
                      <span class="badge bg-success d-block mb-1">{{ konu.dogru_sayisi }}</span>
                      <small class="text-muted">DoÄŸru</small>
                    </div>
                    <div class="col-3">
                      <span class="badge bg-danger d-block mb-1">{{ konu.yanlis_sayisi }}</span>
                      <small class="text-muted">YanlÄ±ÅŸ</small>
                    </div>
                    <div class="col-3">
                      <span class="badge bg-warning d-block mb-1">{{ konu.bos_sayisi }}</span>
                      <small class="text-muted">BoÅŸ</small>
                    </div>
                    <div class="col-3">
                      <span class="badge bg-info d-block mb-1">{{ konu.toplam_soru }}</span>
                      <small class="text-muted">Toplam</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div *ngIf="!loadingKonuAnalizi && konuAnalizi.length === 0" class="empty-state text-center py-4">
              <i class="bi bi-graph-up text-muted" style="font-size: 3rem;"></i>
              <h5 class="text-muted mt-3">HenÃ¼z Konu Analizi Yok</h5>
              <p class="text-muted">SÄ±nav Ã§Ã¶zdÃ¼kÃ§e konu baÅŸarÄ± analiziniz burada gÃ¶rÃ¼necek</p>
            </div>
            <!--Ä°Ã§erik Son-->
          </div>
        </div>
    </div>
  </div>
</div>

<!-- Missing Info Modal -->
<div class="missing-info-modal-overlay" *ngIf="showMissingInfoModal" (click)="closeMissingInfoModal()">
  <div class="missing-info-modal-content" (click)="$event.stopPropagation()">
    <div class="missing-info-modal-header">
      <div class="modal-icon">
        <i class="bi bi-exclamation-triangle-fill text-warning"></i>
      </div>
      <h4>Eksik Bilgiler</h4>
      <button type="button" class="close-btn" (click)="closeMissingInfoModal()">
        <i class="bi bi-x"></i>
      </button>
    </div>

    <div class="missing-info-modal-body">
      <p>Profil bilgilerinizde eksiklikler bulunmaktadÄ±r. LÃ¼tfen aÅŸaÄŸÄ±daki bilgileri tamamlayÄ±nÄ±z:</p>
      
      <ul class="missing-fields-list">
        <li *ngFor="let field of missingFields" class="missing-field-item">
          <i class="bi bi-chevron-right"></i>
          <span>{{ field }}</span>
        </li>
      </ul>

      <div class="info-note">
        <i class="bi bi-info-circle"></i>
        <span>Bu bilgiler eÄŸitim sÃ¼recinizin takibi iÃ§in gereklidir.</span>
      </div>
    </div>

    <div class="missing-info-modal-footer">
      <button type="button" class="btn btn-secondary" (click)="closeMissingInfoModal()">
        <i class="bi bi-x-circle"></i>
        Daha Sonra
      </button>
      <button type="button" class="btn btn-primary" (click)="goToProfile()">
        <i class="bi bi-person-fill"></i>
        Profili Tamamla
      </button>
    </div>
  </div>
</div>

