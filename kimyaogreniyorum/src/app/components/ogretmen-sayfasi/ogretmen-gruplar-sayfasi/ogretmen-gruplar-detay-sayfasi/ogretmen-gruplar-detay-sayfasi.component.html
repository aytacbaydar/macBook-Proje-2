
<div class="group-detail-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="page-title">
          <i class="bi bi-people-fill me-2"></i>
          {{ grupDetay?.name || grupAdi }}
        </h1>
        <p class="page-description">Grup detayları ve öğrenci bilgileri</p>
      </div>

      <!-- Stats Cards -->
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-icon bg-primary">
            <i class="bi bi-people-fill"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ grupDetay?.students?.length || 0 }}</div>
            <div class="stat-label">Toplam Öğrenci</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon bg-success">
            <i class="bi bi-person-check-fill"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ getActiveStudentCount() }}</div>
            <div class="stat-label">Aktif Öğrenci</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon bg-info">
            <i class="bi bi-book-fill"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ grupDetay?.dersKayitlari?.length || 0 }}</div>
            <div class="stat-label">Ders Kaydı</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>Grup detayları yükleniyor...</p>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error-container">
    <div class="error-card">
      <i class="bi bi-exclamation-triangle-fill error-icon"></i>
      <h3>Hata Oluştu</h3>
      <p>{{ error }}</p>
      <button class="retry-button" (click)="loadGrupDetay()">
        <i class="bi bi-arrow-clockwise me-1"></i>
        Tekrar Dene
      </button>
    </div>
  </div>

  <!-- Content Section -->
  <div *ngIf="!isLoading && !error" class="content-section">
    
    <!-- Students Section -->
    <div class="full-width-section-card">
      <div class="section-card-header" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
        <div class="section-header-left">
          <div class="section-icon">
            <i class="bi bi-people-fill"></i>
          </div>
          <div class="section-info">
            <h2 class="section-title">Öğrenciler</h2>
            <div class="section-meta">
              <span class="section-count">
                <i class="bi bi-person-fill me-1"></i>
                {{ grupDetay?.students?.length || 0 }} öğrenci
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="section-content">
        <div *ngIf="!grupDetay?.students?.length" class="empty-section-message">
          <div class="empty-icon">
            <i class="bi bi-person-x"></i>
          </div>
          <p>Bu grupta henüz öğrenci bulunmuyor</p>
        </div>

        <div *ngIf="grupDetay?.students?.length > 0" class="students-grid">
          <div class="student-card-item" *ngFor="let student of grupDetay.students">
            <div class="student-avatar-container">
              <img class="student-avatar" 
                   [src]="student.avatar || getDefaultAvatar(student.adi_soyadi)" 
                   [alt]="student.adi_soyadi">
              <div class="student-status-indicator" 
                   [class.active]="student.aktif" 
                   [class.inactive]="!student.aktif">
                <i class="bi" 
                   [class.bi-check-circle-fill]="student.aktif" 
                   [class.bi-x-circle-fill]="!student.aktif"></i>
              </div>
            </div>
            
            <div class="student-details">
              <h4 class="student-name">{{ student.adi_soyadi }}</h4>
              <p class="student-email">{{ student.email }}</p>
              <div class="student-status-badge" 
                   [class.active-badge]="student.aktif" 
                   [class.inactive-badge]="!student.aktif">
                {{ student.aktif ? 'Aktif' : 'Pasif' }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Schedule Section -->
    <div class="full-width-section-card" *ngIf="grupDetay?.dersProgram?.length > 0">
      <div class="section-card-header" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
        <div class="section-header-left">
          <div class="section-icon">
            <i class="bi bi-calendar-week-fill"></i>
          </div>
          <div class="section-info">
            <h2 class="section-title">Ders Programı</h2>
            <div class="section-meta">
              <span class="section-count">
                <i class="bi bi-clock-fill me-1"></i>
                {{ grupDetay.dersProgram.length }} ders
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="section-content">
        <div class="schedule-grid">
          <div class="schedule-item" *ngFor="let ders of grupDetay.dersProgram">
            <div class="schedule-day">{{ ders.gun }}</div>
            <div class="schedule-time">{{ ders.saat }}</div>
            <div class="schedule-subject">{{ ders.ders_adi }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Lessons Section -->
    <div class="full-width-section-card">
      <div class="section-card-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="section-header-left">
          <div class="section-icon">
            <i class="bi bi-book-fill"></i>
          </div>
          <div class="section-info">
            <h2 class="section-title">İşlenen Konular</h2>
            <div class="section-meta">
              <span class="section-count">
                <i class="bi bi-file-earmark-pdf-fill me-1"></i>
                {{ grupDetay?.dersKayitlari?.length || 0 }} ders kaydı
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="section-content">
        <div *ngIf="!grupDetay?.dersKayitlari?.length" class="empty-section-message">
          <div class="empty-icon">
            <i class="bi bi-file-earmark-pdf"></i>
          </div>
          <p>Bu grup için henüz hiç ders kaydı bulunmuyor</p>
        </div>

        <div *ngIf="grupDetay?.dersKayitlari?.length > 0" class="lessons-grid">
          <div class="lesson-card" *ngFor="let ders of grupDetay.dersKayitlari">
            <div class="lesson-header">
              <div class="lesson-icon">
                <i class="bi bi-file-earmark-pdf-fill"></i>
              </div>
              <div class="lesson-info">
                <h4 class="lesson-title">{{ ders.pdf_adi }}</h4>
                <p class="lesson-date">{{ formatDate(ders.created_at) }}</p>
              </div>
            </div>
            
            <div class="lesson-actions">
              <button class="lesson-action-btn view-btn" (click)="viewPdf(ders.pdf_yolu)">
                <i class="bi bi-eye-fill"></i>
                <span>Görüntüle</span>
              </button>
              <button class="lesson-action-btn download-btn" (click)="downloadPdf(ders.pdf_yolu, ders.pdf_adi)">
                <i class="bi bi-download"></i>
                <span>İndir</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- PDF Modal -->
  <div *ngIf="showPdfModal" class="pdf-modal-overlay" (click)="closePdfModal()">
    <div class="pdf-modal" (click)="$event.stopPropagation()">
      <div class="pdf-modal-header">
        <h3>PDF Görüntüleyici</h3>
        <button class="close-btn" (click)="closePdfModal()">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
      <div class="pdf-modal-content">
        <iframe [src]="selectedPdf" width="100%" height="100%"></iframe>
      </div>
    </div>
  </div>
</div>
