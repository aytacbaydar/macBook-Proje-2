<div class="groups-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="page-title">
          <i class="bi bi-people-fill me-2"></i>
          Öğrenci Grupları
        </h1>
        <p class="page-description">Öğrencilerinizi gruplarına göre yönetin ve takip edin</p>
      </div>

      <!-- Stats Cards -->
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-icon bg-primary">
            <i class="bi bi-collection-fill"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ groups.length }}</div>
            <div class="stat-label">Toplam Grup</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon bg-success">
            <i class="bi bi-people-fill"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ getTotalStudents() }}</div>
            <div class="stat-label">Toplam Öğrenci</div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon bg-info">
            <i class="bi bi-person-check-fill"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ getActiveStudents() }}</div>
            <div class="stat-label">Aktif Öğrenci</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Search Section -->
    <div class="search-section">
      <div class="search-container">
        <div class="search-input-wrapper">
          <i class="bi bi-search search-icon"></i>
          <input 
            type="text" 
            class="search-input" 
            placeholder="Grup veya öğrenci ara..." 
            [(ngModel)]="searchQuery">
          <button *ngIf="searchQuery" class="clear-search-btn" (click)="searchQuery = ''">
            <i class="bi bi-x"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>Gruplar yükleniyor...</p>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error-container">
    <div class="error-card">
      <i class="bi bi-exclamation-triangle-fill error-icon"></i>
      <h3>Hata Oluştu</h3>
      <p>{{ error }}</p>
      <button class="retry-button" (click)="loadStudents()">
        <i class="bi bi-arrow-clockwise me-1"></i>
        Tekrar Dene
      </button>
    </div>
  </div>

  <!-- Groups Grid -->
  <div *ngIf="!isLoading && !error && filteredGroups.length > 0" class="groups-grid">
    <div class="group-card" *ngFor="let group of filteredGroups">
      <!-- Group Header -->
      <div class="group-header">
        <div class="group-icon" [style.background-color]="group.color">
          <i class="bi bi-people-fill"></i>
        </div>
        <div class="group-info">
          <h3 class="group-name">{{ group.name }}</h3>
          <span class="group-count">{{ group.students.length }} öğrenci</span>
        </div>
        <div class="group-badge" [style.background-color]="group.color + '20'" [style.color]="group.color">
          <i class="bi bi-mortarboard-fill me-1"></i>
          Aktif
        </div>
      </div>

      <!-- Students List -->
      <div class="students-section">
        <div class="students-header">
          <h4>Öğrenciler</h4>
          <span class="students-count">{{ group.students.length }} kişi</span>
        </div>

        <div class="students-list">
          <div class="student-item" *ngFor="let student of group.students.slice(0, 3)">
            <div class="student-avatar">
              <img [src]="student.avatar || getDefaultAvatar(student.adi_soyadi)" 
                   [alt]="student.adi_soyadi">
            </div>
            <div class="student-info">
              <span class="student-name">{{ student.adi_soyadi }}</span>
              <span class="student-email">{{ student.email }}</span>
            </div>
            <div class="student-status" [class.active]="student.aktif">
              <i class="bi" [class.bi-check-circle-fill]="student.aktif" 
                           [class.bi-x-circle-fill]="!student.aktif"></i>
            </div>
          </div>

          <!-- More students indicator -->
          <div class="more-students" *ngIf="group.students.length > 3">
            <span>+{{ group.students.length - 3 }} diğer öğrenci</span>
          </div>
        </div>
      </div>

      <!-- Group Stats -->
      <div class="group-stats">
        <div class="mini-stat-card">
          <div class="mini-stat-icon success">
            <i class="bi bi-person-check-fill"></i>
          </div>
          <div class="mini-stat-content">
            <h4>{{ getActiveStudentsInGroup(group) }}</h4>
            <p>Aktif</p>
          </div>
        </div>

        <div class="mini-stat-card">
          <div class="mini-stat-icon warning">
            <i class="bi bi-clock-fill"></i>
          </div>
          <div class="mini-stat-content">
            <h4>{{ getInactiveStudentsInGroup(group) }}</h4>
            <p>Pasif</p>
          </div>
        </div>

        <div class="mini-stat-card">
          <div class="mini-stat-icon info">
            <i class="bi bi-book-fill"></i>
          </div>
          <div class="mini-stat-content">
            <h4>12</h4>
            <p>Ders</p>
          </div>
        </div>
      </div>

      <!-- Group Actions -->
      <div class="group-actions">
        <button class="modern-action-btn detail-btn" (click)="viewGroupDetail(group.name)">
          <div class="btn-icon-wrapper">
            <i class="bi bi-eye-fill"></i>
          </div>
          <div class="btn-content">
            <span class="btn-title">Detay Görüntüle</span>
            <span class="btn-subtitle">Grup bilgileri</span>
          </div>
        </button>
        
        <button class="modern-action-btn attendance-btn" (click)="goToAttendance(group.name)">
          <div class="btn-icon-wrapper">
            <i class="bi bi-clipboard-check-fill"></i>
          </div>
          <div class="btn-content">
            <span class="btn-title">Yoklama Al</span>
            <span class="btn-subtitle">Devamsızlık takibi</span>
          </div>
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && !error && filteredGroups.length === 0 && groups.length > 0" class="empty-state">
    <div class="empty-content">
      <div class="empty-icon">
        <i class="bi bi-search"></i>
      </div>
      <h3>Arama Sonucu Bulunamadı</h3>
      <p>Aradığınız kriterlere uygun grup bulunamadı.</p>
      <button class="empty-action-btn" (click)="searchQuery = ''">
        <i class="bi bi-arrow-clockwise me-1"></i>
        Filtreleri Temizle
      </button>
    </div>
  </div>

  <!-- No Groups State -->
  <div *ngIf="!isLoading && !error && groups.length === 0" class="empty-state">
    <div class="empty-content">
      <div class="empty-icon">
        <i class="bi bi-people"></i>
      </div>
      <h3>Henüz Grup Bulunmuyor</h3>
      <p>Henüz hiç öğrenci grubunuz yok. Öğrenciler otomatik olarak gruplarına göre burada görünecektir.</p>
    </div>
  </div>
</div>